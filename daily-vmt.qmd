---
title: "Daily VMT"
---

```{r}
#| include: false

library(dplyr)
library(echarts4r)

data_url <- "https://raw.githubusercontent.com/vehicletrends/vehicletrends/refs/heads/main/data-raw/vmt_daily.csv"
data <- read.csv(data_url)

# Helper function to create a chart for a given facet
make_chart <- function(data, facet_var, facet_value, line_var) {
  chart_data <- data |>
    filter(.data[[facet_var]] == facet_value)

  chart_data |>
    group_by(.data[[line_var]]) |>
    e_charts(miles) |>
    e_line(quantile, symbol = "none", smooth = FALSE) |>
    e_tooltip(trigger = "axis") |>
    e_x_axis(name = "DVMT") |>
    e_y_axis(name = "Quantile") |>
    e_legend(
      show = TRUE,
      orient = "horizontal",
      left = "center",
      bottom = 0,
      width = "70%",
      selector = list(
        list(type = "all", title = "All"),
        list(type = "inverse", title = "Inverse")
      ),
      selectorPosition = "start"
    ) |>
    e_grid(bottom = 100) |>
    e_color(background = "transparent") |>
    e_toolbox_feature(feature = "dataZoom") |>
    e_toolbox_feature(feature = "saveAsImage")
}
```

This page shows the distribution of daily vehicle miles traveled (VMT) across all vehicles in the dataset. Each chart displays quantiles of daily mileage for a given combination of powertrain and vehicle type. For example, the 0.5 quantile represents the median daily mileage (half of vehicles drive less than this amount and half drive more).

::: {.panel-tabset}

## By Vehicle Type

*Click legend items to show/hide lines.*

::: {.grid}

::: {.g-col-6}
#### Car
```{r}
make_chart(data, "vehicle_type", "Car", "powertrain")
```
:::

::: {.g-col-6}
#### SUV
```{r}
make_chart(data, "vehicle_type", "SUV", "powertrain")
```
:::

::: {.g-col-6}
#### CUV
```{r}
make_chart(data, "vehicle_type", "CUV", "powertrain")
```
:::

::: {.g-col-6}
#### Pickup
```{r}
make_chart(data, "vehicle_type", "Pickup", "powertrain")
```
:::

::: {.g-col-6}
#### Minivan
```{r}
make_chart(data, "vehicle_type", "Minivan", "powertrain")
```
:::

:::

## By Powertrain

*Click legend items to show/hide lines.*

::: {.grid}

::: {.g-col-6}
#### BEV
```{r}
make_chart(data, "powertrain", "BEV", "vehicle_type")
```
:::

::: {.g-col-6}
#### Conventional
```{r}
make_chart(data, "powertrain", "Conventional", "vehicle_type")
```
:::

::: {.g-col-6}
#### Hybrid
```{r}
make_chart(data, "powertrain", "Hybrid", "vehicle_type")
```
:::

::: {.g-col-6}
#### PHEV
```{r}
make_chart(data, "powertrain", "PHEV", "vehicle_type")
```
:::

:::

## Data

<center>
[Download data](https://raw.githubusercontent.com/vehicletrends/vehicletrends/refs/heads/main/data-raw/vmt_daily.csv)

<div style="width:900px">

```{r}
data |>
  mutate(
    miles = round(miles, 2)
  ) |>
  rename(
    Powertrain = powertrain,
    `Vehicle Type` = vehicle_type,
    Quantile = quantile,
    Miles = miles
  ) |>
  reactable::reactable(
    searchable = TRUE,
    highlight = TRUE,
    filterable = TRUE,
    defaultPageSize = 10,
    showPageSizeOptions = TRUE,
    pageSizeOptions = c(5, 10, 25, 50)
  )
```

</div>
</center>

:::
